[introduction]
explain: In this tutorial, we are going to install Radicale.
header: yes

[make sure a maintenance root exists]
mkdir: /var/www/maint/www
group: www-data
owner: www-data
recursive: yes

[about maintenance root]
explain: The maintenance root is used to register an SSL certificate (below) before the site is completed and (later) after the site is live.

[install radicale]
pip3: radicale

[install radicale screenshot]
screenshot: images/install.png
caption: Radical Installed

[create radicale configuration directory]
mkdir: /etc/radicale/config
owner: radicale
recursive: yes

[create the radicale configuration file]
template: config.ini /etc/radicale/config/config.ini

[create the radicale user]
user.add: radicale
home: /
login: /sbin/nologin
system: yes
; useradd --system --user-group --home-dir / --shell /sbin/nologin radicale

[create the systemd service file for radicale]
template: radicale.service /etc/systemd/system/radicale.service
lang: ini

[start the radicale service]
start: radicale

[disable the default site]
apache.disable_site: default

[create the initial apache config file]
template: httpd.conf /etc/apache2/sites-available/{{ domain_name }}.conf

[enable the site]
apache.enable_site: {{ domain_name }}
;
[reload apache]
apache.reload:

[get an SSL cert]
ssl: {{ domain_name }}
email: {{ webmaster_email }}

[create the SSL version of the apache config file]
template: httpd.conf /etc/apache2/sites-available/{{ domain_name }}.conf
ssl_enabled: yes

[restart apache]
apache.restart:
